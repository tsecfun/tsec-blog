---
title: 漏洞管理过程中的定量计算方法
date: 2023-02-01
author: tsec
desc: 漏洞管理对于企业安全管理是非常重要的一环，如何度量漏洞管理的好坏也是企业管理者、业务团队、技术团队共同需要思考的问题。
img: https://pic.hackmyhome.top/i/michael-lee-nJVNGT3gHbw-unsplash.jpg
imgWidth: 800
imgHeight: 500
---

漏洞管理对于企业安全管理是非常重要的一环，如何度量漏洞管理的好坏也是企业管理者、业务团队、技术团队共同需要思考的问题。

在日常的漏洞管理过程中，安全人员一般会按照某类资产漏扫发现的漏洞数量来评判当前资产的安全风险，最终数据的呈现效果就如下图：

![](https://pic.hackmyhome.top/i/202210121459879.jpg)

在实际执行过程中，不同类型的扫描器风险定义方法不一致，不同扫描器扫出来的结果不一致，无法进行数据的聚合分析。

由于漏洞管理是一个常态化过程，包括漏洞扫描或渗透测试发现漏洞、对严重漏洞进行临时缓解、存在漏洞的系统/应用打补丁、已修复漏洞的复测等、漏洞是否被利用的排查等多个部分。

**本篇文章我们讨论一种漏洞度量指标和管理方法，帮助您跟踪组织内漏洞管理过程的健康状态。**

## 漏洞管理是过程管理，而非结果管理

首先我们明确漏洞管理是对其过程的管理，**而非追求“0漏洞”或者“单次漏洞量”增减**。否则安全人员只需要调整一下扫描策略就能达到最终的目标，这样是没有意义的。

整个漏洞管理过程链条如下：漏洞发现->漏洞评估->漏洞处置->复测闭环

此处我们可以类比服务的可用性指标，在某个时间段（周、月、季）内计算服务不可用的情况，假设我们需要计算某一项服务在30天内的可用性情况，如果这30天内关闭了1天，那可用性就变成**1-1/30=29/30=96.7%**，这里分母是服务应该已经启动和运行的天数。

同样如果我们有1000台服务器，30天内可以理解为30000个资产天数，这里我们称之为资产容量（AC），脆弱资产容量（VAC）是资产易受攻击的天数。有了这两个数字就可以计算漏洞管理的健康状况（VMH）。
![](https://pic.hackmyhome.top/i/202210121459777.jpg)

这个公式的参数都是比较理想化的状态，资产容量通过资产管理平台导入，脆弱资产仅定义为有漏洞/无漏洞，下面我们讨论更复杂的情况。

## 初级的方法

假设我们有 5 台服务器，30天服务器都在安全团队的管理范畴，在第15天发现其中有2台服务器存在漏洞（服务器2和服务器5），然后在5天后修复，直观图来看如下：
![](https://pic.hackmyhome.top/i/202210121459521.jpg)

计算脆弱资产容量（VAC）仅代表存在漏洞的资产天数，这样公式就可以这样表达：
![](https://pic.hackmyhome.top/i/202210121459606.jpg)

通用公式表示为：
![](https://pic.hackmyhome.top/i/202210121459342.jpg)

*其中N是服务器数量*

## 多漏洞的计算方法

上述公式只根据服务器是否存在漏洞认定易受攻击资产，但一个资产不可能只存在一个漏洞，对于多个漏洞我们可以将具有多个漏洞的资产视为多个虚拟资产，每个资产只有一个漏洞，这样上述简单的方法依然可以使用。

基于上边服务器示例的简单方法，假设在其中一台服务器上检测到 3 个漏洞，然后在几天后修复了漏洞：

![](https://pic.hackmyhome.top/i/202302020126615.jpg)

我们将一个服务器“扩展”成 3 个虚拟服务器，每个服务器都有 1 个漏洞。应用公式后计算结果如下：
![](https://pic.hackmyhome.top/i/202302020126660.jpg)

这种情况通用公式为：
![](https://pic.hackmyhome.top/i/202302020126600.png)

*其中N为服务器数量，V为漏洞数量也就是扩展服务器数量*

## 增加规定修复时间的计算方法

在实际漏洞管理过程中，我们一般会规定漏洞修复的时间，如果按照上边的公式只要存在漏洞，最终的VMH永远无法达到100%，这样计算出来的数据也不符合我们实际情况。

这里我们补充一个条件：**规定修复时间**，只有在目标修复期内没有修复漏洞时，它才会开始影响脆弱资产容量。

让我们在前面的 5 台服务器示例的基础上，假设每个漏洞的目标修复时间是 2 天：

![](https://pic.hackmyhome.top/i/202302020125240.jpg)

上面的橙色表示服务器易受攻击，但仍在目标修复时间窗口内

现在，资产上存在漏洞的前两天不再对 VAC 造成影响。我们使用这种方法计算的 VMH 变为：

![](https://pic.hackmyhome.top/i/202302020125283.jpg)

这样如果在规定时间内完成了漏洞的修复，意味着漏洞管理做的是比较好的。

更新后的 VMH 公式现在是这样的：
![](https://pic.hackmyhome.top/i/202302020125536.png)

## 最终：不同级别漏洞的计算方法

最终我们还需要再考虑一个因素，就是漏洞的威胁程度并不相同，高危漏洞被成功利用会产生更大的影响，所以这里边我们可以有不同的方法来调整VMH值。

首先需要根据不同的漏洞级别调整漏洞修复的时间，严重漏洞修复时间更短。

其次是要根据漏洞严重性调整漏洞对脆弱资产容量 VAC 的影响，如果一个漏洞在目标修复时间之后仍未修复，那么可以通过某种加权来均衡漏洞对脆弱资产容量的影响。可以参考[CVSSv3](https://www.first.org/cvss/specification-document#Qualitative-Severity-Rating-Scale)或者其他漏洞评级标准。这里以CVSSv3为例，CVSSv3分数除以10后，权重就控制在[0,1]之间。

假设上面示例中的 Server 3 漏洞的 CVSSv3 分数分别为 9.5、8.8 和 7.1：

![](https://pic.hackmyhome.top/i/202302020125496.jpg)

将上面讨论的所有规则应用于此示例，VMH 将是：

![](https://pic.hackmyhome.top/i/202302020125891.jpg)

最终公式如下：
![](https://pic.hackmyhome.top/i/202302020125258.png)

## 结论

根据上边的讨论过程，整体公式还可以再进行推导和细化，比如加入对复测时间的控制。你可以以此方法为基础调整适合自己企业场景的漏洞计算方法。希望对你有帮助。

